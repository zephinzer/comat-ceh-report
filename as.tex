\documentclass[11pt, oneside]{article}   	% use "amsart" instead of "article" for AMSLaTeX format
\usepackage{geometry}                		% See geometry.pdf to learn the layout options. There are lots.
\geometry{letterpaper}                   		% ... or a4paper or a5paper or ... 
%\geometry{landscape}                		% Activate for rotated page geometry
%\usepackage[parfill]{parskip}    		% Activate to begin paragraphs with an empty line rather than an indent
\usepackage{graphicx}				% Use pdf, png, jpg, or epsÂ§ with pdflatex; use eps in DVI mode
								% TeX will automatically convert eps --> pdf in pdflatex		
\usepackage{amssymb}
\usepackage{verbatim}
\usepackage{url}

%text variables%
\newcommand{\myName}{OHYES SECURITY INC}
\newcommand{\clientName}{OHNO PTE LTD}
\newcommand{\projectCosting}{SGD\$10,748.38}
%/text variables%
\newcommand*{\SignatureAndDate}[1]{%
  \par\noindent\makebox[2.5in]{\hrulefill} \hfill\makebox[2.0in]{\hrulefill}%
  \par\noindent\makebox[2.5in][l]{#1}      \hfill\makebox[2.0in][l]{Date}%
}

\setlength{\parskip}{1ex} %--skip lines between paragraphs
\setlength{\parindent}{0pt} %--don't indent paragraphs

\title{
	Vulnerability Report for\\
	\clientName{}
}
\author{
	prepared by\\
	JOSEPH MATTHIAS GOH\\
	\myName{}
}
\date{on 15/12/2016}
\begin{document}

\maketitle
\newpage

\tableofcontents
\newpage

\section{Executive Summary}
\clientName{} has indicated unusual behaviour on a machine
with a Windows 7 Enterprise operating system installed. The machine
in question is being used as a local continuous integration (CI) server
for their primary product, Nobuty, and is used to run regression tests 24/7.\\

Due to a new company policy on being able to access their CI server from
anywhere in the world, the development team has disabled the default
firewall one year ago but have only recently noticed that the machine
shuts down at random times of the day, and the technical lead suspects
that the machine has been compromised by hackers. The machine has since
been isolated together with another machine that acts as a backup. Both
machines are on the same network.\\

\myName{} has been tasked with doing a general scan of \clientName{}'s 
networks and to provide recommendations on possible courses of action
to the management team.

\clearpage
\section{Security Assessment Agreement}
\label{SecurityAssessmentAgreement}
\subsection{Overview}
\clientName{} has requested \myName{} to perform an Internal Network
Vulnerability Assessment for up to 255 local network IP addresses on a
single network with the goal of validating suspected vulnerabilities
in \clientName{}'s  computing infrastructure. Services will be performed
on-site in the  presence of a project manager assigned by \clientName{}.\\

The engagement period was agreed to be between 12th December 2016 to 31st December 2016.

\subsection{Vendor Responsibilities}
\begin{itemize}
\item{
	Conduct a scan on the network to confirm the number of computers
	on the network for up to 255 local network addresses.
}
\item{
	Identify the offending computer identified by Asset Tag No.
	XCAON-18553231-A running Windows 7 Enterprise and perform
	a vulnerability scan on it.
}
\item {
	Perform data correation by researching on vulnerabilities,
	eliminating false positives where possible, investigating
	the potential impact of the findings, and providing recommended
	remediations.
}
\item{
	Provide Client with a Machine Vulnerability Assessment Report.
}
\end{itemize}
\subsection{Client Responsibilities}
\begin{itemize}
\item {
	Identify an on-site project manager to assist in coordinating 
	Client's resource(s).
}
\item{
	Provide \myName{} with access to the business site during
	Standard Business Hours including buildings, parking, phone systems,
	internet access, server rooms and workstations.
}
\item{
	Provide \myName{} with access to a suitable conference room 
	facility for mettings, interviews and facilitated sessions during 
	the engagement period.
}
\item{
	Provide physical and wireless access to the offending network
}
\item{
	Provide access to available resources related to the business
	and technical environment including operating systems, network
	and any computing environments necessary for \myName{} to
	complete the Services.
}
\item{
	Review with \myName{} the completed Assessment Report
}
\item{
	Provide sign-off for completed Machine Vulnerability Assessement
	services.
}

\end{itemize}

\subsection{Fees}
\clientName{} has agreed to pay \myName{} \projectCosting{} for the
afore-describe service.

\subsection{Waiver of Liability}
\begin{itemize}
\item{
	Client understands and acknowledges that where \myName{} has
	exercised reasonable precautions in delivering the Service, OHYES
	SECURITY is not responsible for system outages, degradation of
	performance or other adverse technology environment consequences of
	tasks Client has authorised \myName{} to perform.
}
\item{
	Client represents and warrant that they have sufficient authroity and
	the rights necessary for Client to provide and/or facilitiate OHYES 
	SECURITY's access to information, data, networks, systems, and media in
	connection with these SErvices.
}
\item{
	For all Client requests under this Service Agreement that \myName{}
	posses, access, or analyze particular media, computers, computer networks,
	communications networks, or other systems and equipment, to the extent
	Client provides or facilitates Cisco's access thereto. Client
	represents, warrants and covenants that they have all necessary right, 
	title, license and autrhoity to make such requests and grant such access, 
	including permissions from third-party owners of licensed or shared resources.
}
\item{
	Any delays in provision of necessary test access, environments, VPN 
	connections, user accounts, administrative access, or other required 
	technical assets may result in delay of deliverables and/or reduction of 
	the scope of work performed.
}
\item {
	Client acknowledges that the completion of Services is dependent upon 
	Client meeting its responsibilities as indicated herein.
}
\item {
	Client will identify Client's personnel and define their roles in the 
	participation of the Services. Such personnel may include but is not limited 
	to: architecture design and planning engineers, and network engineers.
}
\item {
	Client will ensure Clients's personnel are available to participate during 
	the course of the Services to provide information and to participate in the 
	scheduled information gathering sessions, interviews, meetings and conference 
	calls.
}
\item {
	Client expressly understands and agrees that support services provided by 
	\myName{} comprise technical advice, assistance and guidance only.
}
\item {
	Client understands that any IP addresses not utilised during the term of 
	the Service will not result in any credit.
}
\item {
	Client expressly understands and agrees that the Services shall take place 
	and complete within fifty (50) calendar days from issuing a Purchase Order to 
	\myName{} for the Services herin and any unused hours will expire.
}
\end{itemize}

\subsection{Authorization}
We, \clientName{}, authorize \myName{} to conduct a security assessment on our
computing infrastructure according to the terms set forth in Section \ref{SecurityAssessmentAgreement}.

\vspace{.5in}
\SignatureAndDate{\clientName{} Representative}
\vspace{.5in}
\SignatureAndDate{\myName{} Representative}

\clearpage
\section{Methodology}

\subsection{Tools}
The following section specifies tools that will be used.

\subsubsection{NMap}
Nmap\footnote{Related Link: \url{https://nmap.org/}} is a free and open 
source utility for network discovery and security auditing. \\

Nmap uses raw IP packets to determine available hosts on a network, what services those
hosts are offering, what operating systems they are running, and what type of firewalls are
in place among other functionalities.


\subsubsection{ZenMap}
ZenMap\footnote{Related Link: https://nmap.org/zenmap/} is an open-source cross-platform
graphical user interface for Nmap which we use to visualise the network.

\subsubsection{Nessus}
Nessus\footnote{Related Link: https://www.tenable.com/products/nessus-vulnerability-scanner} 
is a proprietary vulnerability scanner created by Tenable Network Security. \\

Related Link: https://www.tenable.com/products/nessus-vulnerability-scanner

\subsection{Process}

\begin{enumerate}
\item{Host Discovery}
\subitem{
	We proceed by first scanning the network using Nmap to confirm the number of hosts. 
}
\item{Host Isolation}
\subitem{
	A port scan will be run to determine likelihood of vulnerabilities. A service scan will
	also be run to determine the likelihood of a computer having vulnerabilities.
}
\item{Risk Management}
\subitem{
	A visulisation of the network topology will be generated to understand other hosts and
	identify potential risks in performing a vulnerability scan on the network.
}
\item{Vulnerability Scanning}
\subitem{
	After identification of the offending host, we use Nessus to run a vulnerability scan on it
	to determine exact vulnerabilities which we will generate remdiation steps from.
}
\end{enumerate}

\clearpage
\section{Information Gathering}

\subsection{Nmap Command}
\begin{figure}[h!]
	\fontsize{10pt}{8pt}
	\begin{verbatim}
	nmap -T4 -A -vv -Pn 192.168.108.15
	\end{verbatim}}
	\caption{Nmap command used for gathering information about the network}
\end{figure}

\subsection{Machines on Network}
The scan discovered two hosts, 192.168.108.15 and 192.168.108.88, with 
a large number of open ports on 192.168.108.15 and none on 192.168.108.88.\\

\begin{figure}[h!]
	\fontsize{8pt}{4pt}
	\begin{verbatim}
...

Initiating SYN Stealth Scan at 20:40
Scanning 2 hosts [1000 ports/host]
Completed SYN Stealth Scan against 192.168.108.88 in 8.03s (1 host left)
Discovered open port 49157/tcp on 192.168.108.15
Discovered open port 2103/tcp on 192.168.108.15
Increasing send delay for 192.168.108.15 from 0 to 5 due to 11 out of 11 dropped probes since last increase.
Increasing send delay for 192.168.108.15 from 5 to 10 due to 11 out of 12 dropped probes since last increase.
Discovered open port 49152/tcp on 192.168.108.15
Discovered open port 5357/tcp on 192.168.108.15
Discovered open port 9/tcp on 192.168.108.15
Discovered open port 10243/tcp on 192.168.108.15
Discovered open port 17/tcp on 192.168.108.15
Discovered open port 13/tcp on 192.168.108.15
Discovered open port 49158/tcp on 192.168.108.15
Discovered open port 19/tcp on 192.168.108.15
Discovered open port 7/tcp on 192.168.108.15
Discovered open port 2869/tcp on 192.168.108.15
Discovered open port 49153/tcp on 192.168.108.15
Discovered open port 49155/tcp on 192.168.108.15
Discovered open port 49154/tcp on 192.168.108.15
Discovered open port 2107/tcp on 192.168.108.15
Discovered open port 2105/tcp on 192.168.108.15
Discovered open port 49156/tcp on 192.168.108.15
Discovered open port 135/tcp on 192.168.108.15
Discovered open port 21/tcp on 192.168.108.15
Discovered open port 554/tcp on 192.168.108.15
Discovered open port 3389/tcp on 192.168.108.15
Discovered open port 139/tcp on 192.168.108.15
Discovered open port 445/tcp on 192.168.108.15
Discovered open port 80/tcp on 192.168.108.15
Completed SYN Stealth Scan at 20:40, 37.51s elapsed (2000 total ports)

...
	\end{verbatim}
	\caption{Host Discovery}
\end{figure}

A network topology graph was generated using Nmap to visualise machines on the network as shown
below in Figure 3.

\begin{figure}[h!]
	\centering
	\includegraphics[width=200px]{network.png}
	\caption{Network graph}
	\label{NetworkGraph}
\end{figure}

\subsection{Host Services}

The service scan on 192.168.108.15 revealed the following host services:

\begin{figure}[h!!]
	\fontsize{8pt}{4pt}
	\begin{verbatim}
...

PORT      STATE SERVICE       VERSION
7/tcp     open  echo
9/tcp     open  discard?
13/tcp    open  daytime       Microsoft Windows USA daytime
17/tcp    open  qotd          Windows qotd (English)
19/tcp    open  chargen
21/tcp    open  ftp           FileZilla ftpd 0.9.30 beta
80/tcp    open  http          Microsoft IIS httpd 7.5
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds  Windows 7 Enterprise 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP)
554/tcp   open  rtsp?
2103/tcp  open  msrpc         Microsoft Windows RPC
2105/tcp  open  msrpc         Microsoft Windows RPC
2107/tcp  open  msrpc         Microsoft Windows RPC
2869/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
3389/tcp  open  ms-wbt-server Microsoft Terminal Service
5357/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
10243/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
49152/tcp open  msrpc         Microsoft Windows RPC
49153/tcp open  msrpc         Microsoft Windows RPC
49154/tcp open  msrpc         Microsoft Windows RPC
49155/tcp open  msrpc         Microsoft Windows RPC
49156/tcp open  msrpc         Microsoft Windows RPC
49157/tcp open  msrpc         Microsoft Windows RPC
49158/tcp open  msrpc         Microsoft Windows RPC
...
	\end{verbatim}
	\caption{Port service discovery results}
\end{figure}

\subsection{Miscellaneous Information}
The machine at 192.168.108.15 was identified with the following information which was 
in line with data provided by \clientName{} on the affected machine.
\begin{figure}[h!]
	\fontsize{8pt}{4pt}
	\begin{verbatim}
MAC Address: 08:00:27:FF:21:6D (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Microsoft Windows 7|2008|8.1
OS CPE: cpe:/o:microsoft:windows_7::-\
	cpe:/o:microsoft:windows_7::sp1\
	cpe:/o:microsoft:windows_server_2008::sp1\
	cpe:/o:microsoft:windows_8\
	cpe:/o:microsoft:windows_8.1\
OS details: Microsoft Windows 7 SP0 - SP1, Windows Server 2008 SP1, Windows 8, or Windows 8.1 Update 1
Uptime guess: 0.602 days (since Mon Dec 19 06:18:05 2016)
Network Distance: 1 hop
TCP Sequence Prediction: Difficulty=261 (Good luck!)
IP ID Sequence Generation: Incremental
Service Info: Host: IE10WIN7; OS: Windows; CPE: cpe:/o:microsoft:windows
	\end{verbatim}
	\caption{Device details}
\end{figure}

\clearpage
\section{Vulnerability Scan}

\subsection{Scan Configuration}
A custom policy using all available Plugins and Compliance Checks was used because
no information about the underlying network infrastructure has been made known to us.\\

ARP, TCP and ICMP pings were used.

\begin{figure}[h!]
	\centering
	\includegraphics[width=380pt]{ping-methods.png}
	\caption{Network graph}
	\label{NetworkGraph}
\end{figure}


\subsection{Scan Results}
\begin{figure}[h!]
	\centering
	\includegraphics[width=430pt]{nessus-scan-overview.jpg}
	\caption{Host Scan Overview}
	\label{HostScanOverview}
\end{figure}

The scan on the target as shown in Figure \ref{HostScanOverview} reveals a total of \emph{2} Critical vulnerabilities,
\emph{28} Medium level vulnerabilities and \emph{9} Low level vulnerabilitiies.
In Remediations on the following pages, we provide recommendations on 
ameliorating the risk associated with these vulnerabilities.

\clearpage
\section{Remediations}

We recommend immediate action to be taken for the following two Critical level vulnerabilities:

\begin{enumerate}
\item{OpenSSL 1.0.2 < 1.0.2i Multiple Vulnerabilities (SWEET32) on tcp/80}
\item{OpenSSL 1.0.2 < 1.0.2i Multiple Vulnerabilities (SWEET32) on tcp/443}
\end{enumerate}

\subsection{Solution}
This vulnerability can be resolved by upgrading OpenSSL to version 1.0.2i or later,
which will fix both vulnerabilities that have been identified. \\

Note that the GOST ciphersuites vulnerability (VulnDB 144759) is not yet
fixed by the vendor in an official release; however, a patch for the issue
has been committed to the OpenSSL github repository.\\

We recommend that this be done as soon as possible to avoid exposing business
critical information to potential attackers.

\subsection{Description of Vulnerability}
Critical level of this vulnerability is justified by other vulnerabilities.\\

More information can be assessed at \url{https://sweet32.info/}

\end{document}  